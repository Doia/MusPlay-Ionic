<ion-header no-border>
  <ion-toolbar>
    <ion-buttons slot="start" (click)="goToProfile()">
      <ion-back-button default-href="#"></ion-back-button>
    </ion-buttons>

    <ion-title>Edit Profile</ion-title>

    <ion-buttons slot="end">
      <ion-button (click)="logout()" color="danger">
        <ion-icon slot="icon-only" name="exit"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>

  <!-- Imagen de perfil -->
  <ion-row class="ion-justify-content-center ion-padding">
    <ion-avatar>
      <img [src]="getProfileImageUrl()" (click)="changeProfilePicture()" alt="Profile Picture">
    </ion-avatar>
  </ion-row>

  <!-- Formulario de edición de perfil -->
  <form (ngSubmit)="actualizar(fActualizar)" #fActualizar="ngForm">

    <!-- Primer Nombre -->
    <ion-item class="custom-item">
      <ion-input
        label="Name"
        labelPlacement="floating"
        placeholder="Enter your name"
        name="name"
        type="text"
        [(ngModel)]="temporalUser.name"
        required
      ></ion-input>
    </ion-item>

    <!-- Descripción con contador de caracteres -->
    <ion-item class="custom-item">
      <ion-textarea
        label="Description"
        labelPlacement="floating"
        placeholder="Enter a brief description"
        name="description"
        [(ngModel)]="temporalUser.description"
        maxlength="150"
        (input)="updateCharacterCount()"
        rows="6"
      ></ion-textarea>
      <ion-note *ngIf="showCharCount" color="medium">
        {{ remainingChars }}/150
      </ion-note>
    </ion-item>

    <!-- Información básica del usuario al final del formulario -->
    <ion-list>
      <ion-item class="custom-item">
        <ion-input
          label="Email"
          labelPlacement="floating"
          placeholder="Enter your email"
          name="email"
          type="email"
          [(ngModel)]="temporalUser.email"
          required
        ></ion-input>
      </ion-item>

      <ion-item class="custom-item">
        <ion-input
          label="Username"
          labelPlacement="floating"
          placeholder="Enter your username"
          name="username"
          type="text"
          [(ngModel)]="temporalUser.username"
          required
        ></ion-input>
      </ion-item>

      <ion-item class="custom-item">
        <ion-input
          label="Phone"
          labelPlacement="floating"
          placeholder="Enter your phone number"
          name="phone"
          type="tel"
          [(ngModel)]="temporalUser.phone"
        ></ion-input>
      </ion-item>

      <!-- Nivel de privacidad -->
      <ion-item class="custom-item">
        <ion-label position="stacked">Privacy Level</ion-label>
        <ion-segment [(ngModel)]="temporalUser.privacyLevel" name="privacyLevel">
          <ion-segment-button value="PUBLIC">
            <ion-label>Public</ion-label>
          </ion-segment-button>
          <ion-segment-button value="PRIVATE">
            <ion-label>Private</ion-label>
          </ion-segment-button>
        </ion-segment>
      </ion-item>
    </ion-list>

    <!-- Botón de actualización -->
    <ion-row class="ion-padding-top">
      <ion-col text-center>
        <ion-button type="submit" expand="full" color="tertiary" shape="round">
          Update
        </ion-button>
      </ion-col>
    </ion-row>

  </form> <!-- Aquí cierra la etiqueta form -->

</ion-content>
